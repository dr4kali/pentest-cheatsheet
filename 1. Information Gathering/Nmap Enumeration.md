
Full TCP port scan
```
sudo nmap -p- -T 5 -Pn -n 10.129.2.49
```


Selected TCP port scan
```shell-session
sudo nmap 10.129.2.28 -p 22,25,80,139,445
```

`-p 22,25,80,139,445 # ports one by one`
`-p 22-445           #-p 22-445
`--top-ports=10      # top ports `
`-p-                 # All ports  `
`-F                  # top 100 ports `

Discovering Open UDP Ports
```shell-session
sudo nmap 10.129.2.28 -F -sU
```
|   |   |
|---|---|
|`10.129.2.28`|Scans the specified target.|
|`-sU`|Performs a UDP scan.|
|`-Pn`|Disables ICMP Echo requests.|
|`-n`|Disables DNS resolution.|
|`--disable-arp-ping`|Disables ARP ping.|
|`--packet-trace`|Shows all packets sent and received.|
|`-p 137`|Scans only the specified port.|
|`--reason`|Displays the reason a port is in a particular state.|

Saving the Results
```shell-session
sudo nmap 10.129.2.28 -p- -oA target
```
|   |   |
|---|---|
|`10.129.2.28`|Scans the specified target.|
|`-p-`|Scans all ports.|
|`-oA target`|Saves the results in all formats, starting the name of each file with 'target'.|

Creating html document with xml save file
```shell-session
xsltproc target.xml -o target.html
```

# Nmap Scripting Engine

| **Category** | **Description**                                                                                                                         |
| ------------ | --------------------------------------------------------------------------------------------------------------------------------------- |
| `auth`       | Determination of authentication credentials.                                                                                            |
| `broadcast`  | Scripts, which are used for host discovery by broadcasting and the discovered hosts, can be automatically added to the remaining scans. |
| `brute`      | Executes scripts that try to log in to the respective service by brute-forcing with credentials.                                        |
| `default`    | Default scripts executed by using the `-sC` option.                                                                                     |
| `discovery`  | Evaluation of accessible services.                                                                                                      |
| `dos`        | These scripts are used to check services for denial of service vulnerabilities and are used less as it harms the services.              |
| `exploit`    | This category of scripts tries to exploit known vulnerabilities for the scanned port.                                                   |
| `external`   | Scripts that use external services for further processing.                                                                              |
| `fuzzer`     | This uses scripts to identify vulnerabilities and unexpected packet handling by sending different fields, which can take much time.     |
| `intrusive`  | Intrusive scripts that could negatively affect the target system.                                                                       |
| `malware`    | Checks if some malware infects the target system.                                                                                       |
| `safe`       | Defensive scripts that do not perform intrusive and destructive access.                                                                 |
| `version`    | Extension for service detection.                                                                                                        |
| `vuln`       | Identification of specific vulnerabilities.                                                                                             |

scripts are located at /usr/share/nmap/scripts

```shell-session
sudo nmap 10.129.2.28 -p 25 --script banner,smtp-commands
```



# Firewall and IDS/IPS Evasion

#### ACK-Scan(-sA)

```shell-session
sudo nmap 10.129.2.28 -p 21,22,25 -sA -Pn -n --disable-arp-ping --packet-trace
```

## Decoys(-D RND:5)

```shell-session
sudo nmap 10.129.2.28 -p 80 -sS -Pn -n --disable-arp-ping --packet-trace -D RND:5
```

## DNS Proxying(--source-port ?port?)


```shell-session
udo nmap 10.129.2.28 -p50000 -sS -Pn -n --disable-arp-ping --packet-trace --source-port 53
```

#### Connect To The Filtered Port

```shell-session
ncat -nv --source-port 53 10.129.2.28 50000
```


