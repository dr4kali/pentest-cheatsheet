### FTP

#### Anonymous Login
```shell-session
ftp 10.129.14.136
```

#### Download All Available Files
```shell-session
wget -m --no-passive ftp://anonymous:anonymous@10.129.14.136
```

#### Nmap
```shell-session
sudo nmap -sV -p21 -sC -A 10.129.14.136
```

#### Service Interaction
```shell-session
nc -nv 10.129.14.136 21
telnet 10.129.14.136 21
```

https://academy.hackthebox.com/module/112/section/1066

### SMB

Nmap scan
```shell-session
sudo nmap 10.129.14.128 -sV -sC -p139,445
```

RPClient
```shell-session
rpcclient -U "" 10.129.14.128
```

|**Query**|**Description**|
|---|---|
|`srvinfo`|Server information.|
|`enumdomains`|Enumerate all domains that are deployed in the network.|
|`querydominfo`|Provides domain, server, and user information of deployed domains.|
|`netshareenumall`|Enumerates all available shares.|
|`netsharegetinfo <share>`|Provides information about a specific share.|
|`enumdomusers`|Enumerates all domain users.|
|`queryuser <RID>`|Provides information about a specific user.|

https://academy.hackthebox.com/module/112/section/1067


SMBmap
```shell-session
smbmap -H 10.129.14.128
```

crackmapexec
```shell-session
crackmapexec smb 10.129.14.128 --shares -u '' -p ''
```

Enum4linux
```
 enum4linux 10.129.14.128 -A
```


### NFS

https://academy.hackthebox.com/module/112/section/1068

nmap
```shell-session
sudo nmap 10.129.14.128 -p111,2049 -sV -sC
```

nmap with all scripts
```shell-session
sudo nmap --script nfs* 10.129.14.128 -sV -p111,2049
```

#### Show Available NFS Shares
```shell-session
showmount -e 10.129.14.128
```

#### Mounting NFS Share
```shell-session
mkdir target-NFS
sudo mount -t nfs 10.129.14.128:/ ./target-NFS/ -o nolock
cd target-NFS
tree .
```

#### List Contents with UIDs & GUIDs
```shell-session
ls -n mnt/nfs/
```

#### Unmounting
```shell-session
cd ..
sudo umount ./target-NFS
```



### DNS

#### DIG - NS Query
```shell-session
dig ns inlanefreight.htb @10.129.14.128
```

#### DIG - Version Query
```shell-session
dig CH TXT version.bind 10.129.120.85
```

#### DIG - ANY Query
```shell-session
dig any inlanefreight.htb @10.129.14.128
```

#### DIG - AXFR Zone Transfer
```shell-session
dig axfr inlanefreight.htb @10.129.14.128
```

#### DIG - AXFR Zone Transfer - Internal
```shell-session
dig axfr internal.inlanefreight.htb @10.129.14.128
```

#### Subdomain Brute Forcing
```shell-session
for sub in $(cat /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-110000.txt);do dig $sub.inlanefreight.htb @10.129.14.128 | grep -v ';\|SOA' | sed -r '/^\s*$/d' | grep $sub | tee -a subdomains.txt;done
```

```shell-session
dnsenum --dnsserver 10.129.14.128 --enum -p 0 -s 0 -o subdomains.txt -f /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-110000.txt inlanefreight.htb
```


### SMTP

#### Nmap

```shell-session
sudo nmap 10.129.14.128 -sC -sV -p25
```

#### Nmap - Open Relay

```shell-session
sudo nmap 10.129.14.128 -p25 --script smtp-open-relay -v
```

#### Telnet

```shell-session
telnet 10.129.14.128 25
```

| **Command**  | **Description**                                                                                  |
| ------------ | ------------------------------------------------------------------------------------------------ |
| `AUTH PLAIN` | AUTH is a service extension used to authenticate the client.                                     |
| `HELO`       | The client logs in with its computer name and thus starts the session.                           |
| `MAIL FROM`  | The client names the email sender.                                                               |
| `RCPT TO`    | The client names the email recipient.                                                            |
| `DATA`       | The client initiates the transmission of the email.                                              |
| `RSET`       | The client aborts the initiated transmission but keeps the connection between client and server. |
| `VRFY`       | The client checks if a mailbox is available for message transfer.                                |
| `EXPN`       | The client also checks if a mailbox is available for messaging with this command.                |
| `NOOP`       | The client requests a response from the server to prevent disconnection due to time-out.         |
| `QUIT`       | The client terminates the session.                                                               |


### IMAP/POP3

#### Nmap

```shell-session
sudo nmap 10.129.14.128 -sV -p110,143,993,995 -sC
```

#### cURL

```shell-session
curl -k 'imaps://10.129.14.128' --user user:p4ssw0rd -v
```

#### OpenSSL - TLS Encrypted Interaction POP3

```shell-session
openssl s_client -connect 10.129.14.128:pop3s #or imaps
```



#### IMAP Commands

| **Command**                     | **Description**                                                                                               |
| ------------------------------- | ------------------------------------------------------------------------------------------------------------- |
| `1 LOGIN username password`     | User's login.                                                                                                 |
| `1 LIST "" *`                   | Lists all directories.                                                                                        |
| `1 CREATE "INBOX"`              | Creates a mailbox with a specified name.                                                                      |
| `1 DELETE "INBOX"`              | Deletes a mailbox.                                                                                            |
| `1 RENAME "ToRead" "Important"` | Renames a mailbox.                                                                                            |
| `1 LSUB "" *`                   | Returns a subset of names from the set of names that the User has declared as being `active` or `subscribed`. |
| `1 SELECT INBOX`                | Selects a mailbox so that messages in the mailbox can be accessed.                                            |
| `1 UNSELECT INBOX`              | Exits the selected mailbox.                                                                                   |
| `1 FETCH <ID> all`              | Retrieves data associated with a message in the mailbox.                                                      |
| `1 CLOSE`                       | Removes all messages with the `Deleted` flag set.                                                             |
| `1 LOGOUT`                      | Closes the connection with the IMAP server.                                                                   |

#### POP3 Commands

| **Command**     | **Description**                                             |
| --------------- | ----------------------------------------------------------- |
| `USER username` | Identifies the user.                                        |
| `PASS password` | Authentication of the user using its password.              |
| `STAT`          | Requests the number of saved emails from the server.        |
| `LIST`          | Requests from the server the number and size of all emails. |
| `RETR id`       | Requests the server to deliver the requested email by ID.   |
| `DELE id`       | Requests the server to delete the requested email by ID.    |
| `CAPA`          | Requests the server to display the server capabilities.     |
| `RSET`          | Requests the server to reset the transmitted information.   |
| `QUIT`          | Closes the connection with the POP3 server.                 |


### SNMP

#### SNMPwalk

```shell-session
snmpwalk -v2c -c public 10.129.14.128
```

#### OneSixtyOne

```shell-session
onesixtyone -c /opt/useful/SecLists/Discovery/SNMP/snmp.txt 10.129.14.128
```

#### Braa

```shell-session
braa <community string>@<IP>:.1.3.6.* 
```


### Mysql

#### Scanning MySQL Server

```shell-session
sudo nmap 10.129.14.128 -sV -sC -p3306 --script mysql*
```

|**Command**|**Description**|
|---|---|
|`mysql -u <user> -p<password> -h <IP address>`|Connect to the MySQL server. There should **not** be a space between the '-p' flag, and the password.|
|`show databases;`|Show all databases.|
|`use <database>;`|Select one of the existing databases.|
|`show tables;`|Show all available tables in the selected database.|
|`show columns from <table>;`|Show all columns in the selected database.|
|`select * from <table>;`|Show everything in the desired table.|
|`select * from <table> where <column> = "<string>";`|Search for needed `string` in the desired table.|

### MSSQL

#### NMAP MSSQL Script Scan

```shell-session
sudo nmap --script ms-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell,ms-sql-config,ms-sql-ntlm-info,ms-sql-tables,ms-sql-hasdbaccess,ms-sql-dac,ms-sql-dump-hashes --script-args mssql.instance-port=1433,mssql.username=sa,mssql.password=,mssql.instance-name=MSSQLSERVER -sV -p 1433 10.129.201.248
```

#### MSSQL Ping in Metasploit

```
msfconsole

search mssql_ping
```

```shell-session
msf6 auxiliary(scanner/mssql/mssql_ping) > set rhosts 10.129.201.248

rhosts => 10.129.201.248


msf6 auxiliary(scanner/mssql/mssql_ping) > run

[*] 10.129.201.248:       - SQL Server information for 10.129.201.248:
[+] 10.129.201.248:       -    ServerName      = SQL-01
[+] 10.129.201.248:       -    InstanceName    = MSSQLSERVER
[+] 10.129.201.248:       -    IsClustered     = No
[+] 10.129.201.248:       -    Version         = 15.0.2000.5
[+] 10.129.201.248:       -    tcp             = 1433
[+] 10.129.201.248:       -    np              = \\SQL-01\pipe\sql\query
[*] 10.129.201.248:       - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```

#### Connecting with Mssqlclient.py

```shell-session
python3 mssqlclient.py Administrator@10.129.201.248 -windows-auth
```

